{% extends "szzj/szzj_base.html" %}

{% block title %}{{ album.title }}{% endblock %}

{% block content %}
<div class="ui basic segment">
    <h2 class="ui header">{{ album.title }} <div class="sub header">{{ album.artist.name }}</div></h2>
    <p>{{ album.release_date }}发行，售价{{ album.price }}元。</p>
    <h3 class="ui blue header">各平台销售详情<div class="ui sub header">*销量占比按张数计算。</div></h3>
</div>
<table class="ui blue unstackable table">
    <thead>
    <tr>
        <th>平台</th>
        <th class="right aligned">销量</th>
        <th class="right aligned">金额</th>
        <th class="right aligned">占比</th>
    </tr>
    </thead>
    <tbody>
    {% if album.qq_id %}
    <tr><td>
    {% if album.qq_id != 656743 %}
    <a href="https://y.qq.com/m/digitalbum/gold/index.html?id={{ album.qq_id }}" target="_blank">
    {% else %}
    <a href="https://y.qq.com/m/digitalbum/silver/index.html?id={{ album.qq_id }}" target="_blank">
    {% endif %}
    QQ音乐</a></td>
    {% if album.qq_count > 0 %}
        <td class="right aligned">{% if album.album_only %}{{ album.qq_count }}张{% else %}{{ album.qq_song_count }}首{% endif %}</td>
        <td class="right aligned">{{ album.qq_money }}元</td>
        <td class="right aligned">{% widthratio album.qq_count album.count 100 %}%</td>
    {% else %}
        <td>暂缺</td><td>暂缺</td><td>暂缺</td>
    {% endif %}
    </tr>
    {% endif %}
    {% if album.wyy_id %}
    <tr><td>
    {% if album.wyy_id != 5856052 %}
    <a href="https://music.163.com/store/newalbum/detail?id={{ album.wyy_id }}" target="_blank">
    {% else %}
    <a href="https://music.163.com/store/product/detail?id={{ album.wyy_id }}" target="_blank">
    {% endif %}
    网易云音乐</a></td>
    {% if album.wyy_count > 0 %}
        <td class="right aligned">{{ album.wyy_count }}张</td>
        <td class="right aligned">{{ album.wyy_money }}元</td>
        <td class="right aligned">{% widthratio album.wyy_count album.count 100 %}%</td>
    {% else %}
        <td>暂缺</td><td>暂缺</td><td>暂缺</td>
    {% endif %}
    </tr>
    {% endif %}
    {% if album.kugou_id %}
    <tr><td>
    {% if album.kugou_id <= 69486 %}
    <a href="http://zhuanji.kugou.com/html/mobile_commonchargeV2/index_{{ album.kugou_id }}.html" target="_blank">
    {% else %}
    <a href="http://zhuanjistatic.kugou.com/html/pc_commonchargeV3/index_{{ album.kugou_id }}.html" target="_blank">
    {% endif %}
    酷狗音乐</a></td>
    {% if album.kugou_count > 0 %}
        <td class="right aligned">{% if album.kugou_song_count == 0 %}{{ album.kugou_count }}张{% else %}{{ album.kugou_song_count }}首{% endif %}</td>
        <td class="right aligned">{{ album.kugou_money }}元</td>
        <td class="right aligned">{% widthratio album.kugou_count album.count 100 %}%</td>
    {% else %}
        <td>暂缺</td><td>暂缺</td><td>暂缺</td>
    {% endif %}
    {% endif %}
    {% if album.kuwo_id %}
    <tr><td>
    <a href="http://vip1.kuwo.cn/fans/fans/template/index.html?key={{ album.kuwo_id }}" target="_blank">
    酷我音乐</a></td>
    {% if album.kuwo_count > 0 %}
        <td class="right aligned">{% if album.album_only or album.kuwo_song_count == 0 %}{{ album.kuwo_count }}张{% else %}{{ album.kuwo_song_count }}首{% endif %}</td>
        <td class="right aligned">{{ album.kuwo_money }}元</td>
        <td class="right aligned">{% widthratio album.kuwo_count album.count 100 %}%</td>
    {% else %}
        <td>暂缺</td><td>暂缺</td><td>暂缺</td>
    {% endif %}
    {% endif %}
    </tbody>
    <tfoot><tr><th>总销量</th><th class="right aligned">{{ album.count }}张</th><th class="right aligned">{{ album.money }}元</th><th></th></tr></tfoot>
</table>
<div class="ui basic segment">
    <h3 class="ui blue header">最新销量记录
        <div class="ui sub header">*此功能于2019年5月11日23点上线，在此之前的数据暂无记录。
            <br>*本站销售数据每半小时获取一次，当销售金额有变化时才会生成记录。
            <br>*因网络问题，某一时段的数据可能会获取失败，此时如果实际销售数据发生了变化，本站可能会记录不到。</div>
    </h3>
</div>
<table class="ui blue small very compact unstackable table" data-tab="album">
    <thead>
    <tr>
        <th>时间</th>
        <th>总销量</th>
        <th>QQ音乐</th>
        <th>网易云音乐</th>
        <th>酷狗音乐</th>
        <th>酷我音乐</th>
    </tr>
    </thead>
    <tbody>
    {% for data in data_list %}
    <tr>
        <td>{{ data.time }}</td>
        <td>{{ data.count }}张<br>{{ data.money }}元</td>
        <td>{% if album.album_only %}{{ data.qq_count }}张{% else %}{{ data.qq_song_count }}首{% endif %}<br>{{ data.qq_money }}元</td>
        <td>{{ data.wyy_count }}张<br>{{ data.wyy_money }}元</td>
        <td>{% if data.kugou_song_count == 0 %}{{ data.kugou_count }}张{% else %}{{ data.kugou_song_count }}首{% endif %}<br>{{ data.kugou_money }}元</td>
        <td>{% if album.album_only or data.kuwo_song_count == 0 %}{{ data.kuwo_count }}张{% else %}{{ data.kuwo_song_count }}首{% endif %}<br>{{ data.kuwo_money }}元</td>
    </tr>
    {% endfor %}
    </tbody>
</table>
{% endblock %}
